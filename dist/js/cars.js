"use strict";$(function(){$(".close_slider ").on("click",function(){$(".W_top_banner ").animate({height:0},500,"linear")});var a=document.querySelector(".normal-goods");console.log;var t;function o(e){var n=e.parent().prev().find(".danjia").text();n=$.trim(n),console.log($(".total_price")),console.log(n);var a=n*e.parent().find("input").val();e.parent().next().html("￥"+a.toFixed(2));e.parent().parent().parent().parent().parent().parent().parent().next().find(".payableAmount").html(a.toFixed(2))}function r(){0==$(".add").size()&&$(".queren").remove()}ajax("GET","../api/cars.php","",function(e){var n=JSON.parse(e).map(function(e){return' <div class="W_store_floor">\n                        <div class="store_top clearfix">\n                            <span class="select_tik fl">\n                                <input type="checkbox">\n                            </span>\n                            <a href="javascript:;" class="store_name fl">'+e.dianming+'</a>\n                        </div>\n                        <div class="goods_floor clearfix set" >\n                            <div class="goods_info fl clearfix" data-id='+e.gid+'>\n                                <div class="goods_right clearfix">\n                                    <span class="select_tik  fl">\n                                        <input type="checkbox">\n                                    </span>\n                                    <a href="javascript:;" target="_blank">\n                                        <div class="goods_img fl">\n                                            <img src="'+e.urlimg1+'" alt="">\n                                        </div>\n                                        <div class="goods_txt  fl">\n                                            <div class="goods_a">\n                                                <p class="p1">'+e.title+'</p>\n                                                <p class="specifications">'+e.yangshi+'</p>\n                                            </div>\n                                        </div>\n                                    </a>\n                                    <ul class="fr">\n                                        <li class="unit_price"> ¥<em class="danjia">'+e.danjia+'</em></li>\n                                        <li class="goods_num">\n                                            <span class="reduce calc-btns">-</span>\n                                            <input type="text" class="num" value="'+e.shuliang+'" data-stock="1" readonly="">\n                                            <span class="add calc-btns">+</span>\n                                        </li>\n                                        <li class="total_price">¥<em class="subTotal">'+e.danjia*e.shuliang+'</em></li>\n                                        <li class="others">\n                                            <a href="javascript:;" class="delete_goods">删除</a>\n                                            <a href="javascript:;" class="to_collection">移入收藏</a>\n                                        </li>\n                                    </ul>\n                                </div>\n                            </div>\n                        </div>\n                    </div>'}).join("");a.innerHTML=n}),$(".cart-content").on("click",".add",function(e){t=$(this).prev().val(),10<=++t&&(t=10),console.log(e.target.parentNode.parentNode.parentNode.parentNode.querySelector(".danjia").innerHTML,e.target.parentNode.parentNode.parentNode.parentNode.querySelector(".num").value);var n=e.target.parentNode.parentNode.parentNode.parentNode.dataset.id;ajax("GET","../api/carsupdate.php","valss="+t+"&jiage="+n,function(e){console.log(e)}),$(this).prev().val(t),o($(this));var a=s();c(a),l(a)}),$(".cart-content").on("click",".reduce",function(e){t=$(this).next().val(),--t<=1&&(t=1);var n=e.target.parentNode.parentNode.parentNode.parentNode.dataset.id;ajax("GET","../api/carsupdate.php","valss="+t+"&jiage="+n,function(e){console.log(e)}),$(this).next().val(t),o($(this));s()}),$(".cart-content").on("click",".delete_goods",function(){if(confirm("您确定要删除该商品吗？")){$(this).parent().parent().parent().parent().parent().parent().remove();var e=$(this).parent().prev().prev().prev().find(".danjia").text();console.log(e);ajax("GET","../api/carsdelete.php","jiage="+e,function(e){console.log(e)})}r();var n=s();c(n),l(n)});var i=!0;function s(){for(var e=[],n=$(".set input").size(),a=0;a<n;a++)$(".set input").eq(a).prop("checked")&&e.push(a);return e}function c(e){for(var n=0,a=0;a<e.length;a++)n+=parseInt($(".num").eq(e[a]).val());$(".payableAmount").html(n)}function l(e){for(var n=0,a=0;a<e.length;a++){var t=$(".danjia").eq(e[a]).text();n+=1*(t=$.trim(t))}$(".goodsAmount").html(n.toFixed(2))}$(".select_tik ").on("click",function(){if(i){$(".set  input").prop("checked","checked"),$(".quanxuan input").prop("checked","checked");for(var e=0,n=0,a=0;a<$(".num").length;a++)e+=-1*$(".num").eq(a).val()*-1;for(var t=0;t<$(".subTotal").length;t++)n+=-1*$(".subTotal").eq(t).html()*-1;$("#payableAmount").html(n),$("#goodsAmount").html(n),$("#selectedQuantity").html(e)}else $(".set input").removeAttr("checked"),$(".quanxuan input").removeAttr("checked"),$("#payableAmount").html(0),$("#goodsAmount").html(0),$("#selectedQuantity").html(0);i=!i;s()}),$(".delete_goods").on("click",function(){console.log(123);var e=s();if(confirm("您确定要删除多行吗？"))for(var n=e.length-1;0<=n;n--)$(".set").eq(e[n]).parent().parent().remove();r()}),$(".cart-content").on("click",".gouxuan",function(){var e=s();i=e.length==$(".gouxuan").size()?($(".quanxuan").prop("checked","checked"),!1):($(".quanxuan").removeAttr("checked"),!0),c(e=s()),l(e)})});